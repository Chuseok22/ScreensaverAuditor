# 릴리스 노트: 화면보호기 감사 도구 (ScreensaverAuditor) v3.0

## 주요 변경 사항 (2025년 5월)

### 새로운 GUI 모드 추가 🖥️

- **그래픽 인터페이스 지원**: 이제 기본적으로 GUI 모드로 실행되며 탭 기반의 사용자 친화적인 인터페이스를 제공합니다.
- **실행 모드 전환**: `--console` 옵션을 통해 명령줄 모드로 전환 가능합니다.
- **콘솔 창 자동 숨김**: GUI 모드로 실행 시 콘솔 창을 자동으로 숨겨 사용자 경험을 개선했습니다.

### 권한 관리 개선 🔒

- **관리자 권한 자동 요청 기능 추가**: 애플리케이션 실행 시 자동으로 관리자 권한을 요청하는 매니페스트 설정 추가
- **관리자 권한 확인 프로세스 개선**: 시작 시 권한 확인을 통해 사용자에게 명확한 안내 메시지 제공
- **권한 부족 시 친절한 오류 메시지**: 관리자 권한이 필요한 작업 시도 시 적절한 안내 메시지 표시
- **예외 처리 개선**: 권한 관련 예외 상황에 대한 사용자 친화적인 메시지 제공

### 사용자 인터페이스 개선 🖥️

- **그래픽 사용자 인터페이스(GUI) 추가**: 사용자 친화적인 인터페이스를 추가했습니다.
  - 탭 기반 인터페이스: 감사 설정, 결과 보기, 도움말 탭을 제공합니다
  - 직관적인 폼 컨트롤: 날짜 선택, 사용자 입력, 파일 경로 선택 등
  - 실시간 결과 표시: 감사 결과를 데이터 그리드로 즉시 확인 가능
  - 다양한 화면 해상도 지원: 자동 크기 조정 기능 내장

### 코드 구조 개선 🏗️

- **코드 리팩토링**: 700줄 이상의 코드를 기능별로 분리하여 MVVM 패턴에 맞게 재구성했습니다.
  - `Models`: 데이터 모델 클래스 (ScreensaverEvent, ScreensaverUsage, CommandLineOptions)
  - `Services`: 주요 비즈니스 로직 서비스 (ScreensaverAuditorService, ExcelExporter)
  - `Utils`: 유틸리티 클래스 (CommandLineParser, ConsoleHelper, FormResizer)
  - `UI`: GUI 관련 폼 및 컴포넌트 (MainForm, ViewModel)

### 새로운 기능 🆕

- **`--audit` 명령어 추가**: 기본 설정(최근 7일)으로 간단히 감사를 실행할 수 있습니다.
  ```
  ScreensaverAuditor.exe --audit
  ```

- **JSON 출력 파싱 지원**: PowerShell 명령의 출력을 JSON 형식으로 받아 처리하는 기능이 추가되었습니다.
  - Microsoft JSON 날짜 형식(`/Date(타임스탬프)/`) 특별 처리 로직 구현
  - 다양한 이벤트 메타데이터 추출 기능 개선

### Excel 출력 개선 📊

- **새로운 필드 추가**: Excel 출력에 다음 필드가 추가되었습니다.
  - 이벤트 유형 (화면보호기 시작/종료)
  - 작업 유형 (TaskDisplayName)
  - 활동 ID (ActivityId)
  - 이벤트 제공자 (ProviderName)
  - 감사 결과 (Keywords)

- **시각화 개선**: 
  - 화면보호기 시작 이벤트는 초록색으로 표시
  - 화면보호기 종료 이벤트는 빨간색으로 표시

### 사용성 개선 🧰

- **그래픽 사용자 인터페이스(GUI) 추가**: 사용자 친화적인 UI 환경이 추가되었습니다.
  - 탭 기반의 직관적 인터페이스
  - 날짜 선택기 및 입력 폼
  - 결과를 바로 확인할 수 있는 데이터 그리드
  - Excel 파일 바로 열기 기능
  - 상세 도움말 탭

- **실행 모드 지원**:
  - 기본 실행: GUI 모드
  - `--console` 옵션 추가: 명령줄 인터페이스 모드

- **예외 처리 강화**: 검색 결과가 없을 때 더 상세한 정보를 제공합니다.
  - 검색 기간 표시
  - 사용한 필터 정보 표시
  - 대안 제안

- **JSON 파싱 오류 처리**: JSON 파싱 오류에 대한 예외 처리가 강화되었습니다.

## 업그레이드 안내

- 기존 버전에서 업그레이드 시 별도의 설정 변경 없이 바로 사용할 수 있습니다.
- 이전에 활성화했던 감사 정책은 그대로 유지됩니다.

## 시스템 요구사항

- 이전 버전과 동일한 .NET 6.0 이상 필요
- Windows 운영체제에서만 동작
- Windows Forms 지원 (GUI 모드)

## 알려진 이슈

- 일부 오래된 Windows 버전에서는 JSON 출력 형식이 지원되지 않을 수 있습니다.
- 매우 큰 규모의 이벤트 로그를 처리할 때 메모리 사용량이 증가할 수 있습니다.

## 향후 계획

- 통계 분석 기능 강화
- GUI 기능 확장 (차트 및 그래프 추가)
- 보고서 형식 추가 (PDF, HTML)
- 대시보드 기능 추가
- 원격 감사 기능 추가

---

**개발팀**: Chuseok22
**릴리스 날짜**: 2025년 5월 12일
