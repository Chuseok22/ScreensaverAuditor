# 화면보호기 감사 도구 (ScreensaverAuditor) 📊

화면보호기 감사 도구는 Windows 시스템에서 사용자들의 화면보호기 사용 현황을 쉽고 효율적으로 분석하고 리포트하는 도구입니다. 

보안 정책 준수는 현대 기업 환경에서 매우 중요한 요소입니다. 이 도구를 사용하면 직원들의 화면보호기 사용 패턴을 분석하여 ## 결과 분석 및 활용 가이드 📊

### 데이터 해석 및 분석

![결과 분석](https://예시링크/result_analysis.png)

#### 📑 기본 결과 지표 이해하기

| 지표 | 설명 | 보안 의미 |
|-----|-----|---------|
| **화면보호기 실행 횟수** | 사용자별 화면보호기가 활성화된 총 횟수 | 자리 이탈 시 컴퓨터 보호 빈도 |
| **총 사용 시간** | 화면보호기가 활성 상태로 유지된 총 시간 | 무인 상태 총 지속 시간 |
| **평균 사용 시간** | 화면보호기 세션당 평균 지속 시간 | 평균 자리 이탈 시간 |
| **최장 사용 시간** | 가장 오래 지속된 화면보호기 세션 | 장시간 자리 비움 식별 |
| **미종료 세션** | 종료 이벤트 없는 화면보호기 세션 수 | 강제 종료 또는 시스템 재부팅 횟수 |

#### 🔍 심층 분석 가이드

1. **시간대별 분석**:
   - 점심 시간(12-13시)과 업무 종료 시간(17-18시) 주변 패턴 확인
   - 비업무 시간(18시 이후) 화면보호기 활성화 빈도 분석

2. **사용자별 분석**:
   - 부서 또는 팀별 평균과 비교하여 이상치 식별
   - 특정 사용자의 시간 경과에 따른 패턴 변화 추적

3. **보안 정책 준수 분석**:
   - 화면보호기 활성화 전 평균 대기 시간 계산
   - 조직 보안 정책(예: 5분 이내 활성화)과 비교

### 📈 Excel 보고서 활용 안내

Excel 출력 파일에는 다음 정보가 포함되어 있습니다:

| 열 이름 | 데이터 유형 | 설명 |
|--------|-----------|------|
| **이벤트 시간** | 날짜/시간 | 이벤트 발생 시간 (yyyy-MM-dd HH:mm:ss) |
| **이벤트 ID** | 숫자 | 4802(시작) 또는 4803(종료) |
| **이벤트 유형** | 텍스트 | "화면보호기 시작" 또는 "화면보호기 종료" |
| **컴퓨터 이름** | 텍스트 | 이벤트가 발생한 컴퓨터 식별자 |
| **사용자 계정** | 텍스트 | 이벤트와 연관된 사용자 계정 |
| **세션 ID** | 숫자 | Windows 세션 식별자 |
| **지속 시간(분)** | 숫자 | 화면보호기 활성화 지속 시간 (종료 이벤트에만 해당) |
| **작업 유형** | 텍스트 | Windows 이벤트 작업 유형 |
| **활동 ID** | GUID | Windows 이벤트 활동 식별자 |
| **이벤트 제공자** | 텍스트 | 이벤트를 생성한 Windows 구성 요소 |터링할 수 있습니다. 직관적인 그래픽 인터페이스와 강력한 명령줄 옵션을 모두 제공하여 IT 관리자와 보안 담당자의 업무 효율성을 크게 높여줍니다.

## 주요 기능 🌟

### 데이터 분석 및 보고 기능

- 📋 **화면보호기 이벤트 로그 자동 수집**: Windows 이벤트 로그에서 화면보호기 활성화(4802) 및 비활성화(4803) 이벤트를 자동으로 수집합니다.
- 📊 **사용자별 상세 통계**: 각 사용자의 화면보호기 활성화 횟수, 총 사용 시간, 평균 사용 시간 등 다양한 통계를 제공합니다.
- 📅 **유연한 기간 설정**: 원하는 기간(특정 일자, 주, 월)을 자유롭게 설정하여 데이터를 조회할 수 있습니다.
- 👤 **사용자 기반 필터링**: 특정 사용자나 부서를 대상으로 보고서를 생성할 수 있습니다.
- 📑 **Excel 보고서 생성**: 모든 결과를 Excel 형식으로 자동 내보내기하여 추가 분석이나 보고용으로 활용할 수 있습니다.

### 관리 및 자동화 기능

- 🔐 **감사 정책 자동 설정**: 필요한 Windows 감사 정책을 자동으로 설정하여 별도 설정 없이 바로 사용할 수 있습니다.
- 🔄 **이벤트 매칭 알고리즘**: 화면보호기 시작/종료 이벤트를 자동으로 매칭하여 정확한 사용 시간을 계산합니다.
- 🖥️ **직관적인 그래픽 인터페이스**: 복잡한 명령어 없이 마우스 클릭만으로 모든 기능을 사용할 수 있습니다.
- ⌨️ **명령줄 지원**: 자동화 스크립트나 예약 작업에 활용할 수 있는 명령줄 인터페이스도 제공합니다.

## 시스템 요구사항 💻

### 필수 요구사항
- **운영체제**: Windows 10 이상 (Windows 11, Windows Server 2019/2022 권장)
- **프레임워크**: .NET 6.0 이상
- **화면 해상도**: 최소 1024x768 (GUI 모드 사용 시)
- **권한**: 자동으로 요청되는 관리자 권한 승인 필요

### 권한 관련 안내
- **관리자 권한이 필요한 이유**: 이 애플리케이션은 Windows 이벤트 로그 접근 및 감사 정책 설정을 위해 반드시 관리자 권한이 필요합니다.
- **자동 권한 요청**: 애플리케이션 실행 시 자동으로 UAC(사용자 계정 제어) 대화상자가 표시되어 권한을 요청합니다.
- **보안 영향**: 관리자 권한은 이벤트 로그 접근과 감사 정책 설정에만 사용됩니다. 시스템 파일이나 레지스트리를 변경하지 않습니다.

### 선택 요구사항
- **Microsoft Excel**: 결과 파일을 열어보려면 필요 (Power BI, LibreOffice Calc 등 대체 가능)
- **PowerShell 5.0 이상**: 고급 이벤트 로그 분석 기능 사용 시 권장

## 설치 및 시작하기 📥

### 빠른 설치 가이드
1. [릴리즈 페이지](https://github.com/your-organization/ScreensaverAuditor/releases)에서 최신 버전의 `ScreensaverAuditor.exe` 파일을 다운로드합니다.
2. 원하는 폴더에 파일을 저장합니다 (예: `C:\Program Files\ScreensaverAuditor\`).
3. 첫 실행 시 Windows SmartScreen 경고가 표시될 수 있습니다:
   - "추가 정보" 링크를 클릭한 다음 "실행"을 선택하여 계속 진행하세요.

### 프로그램 실행하기
1. `ScreensaverAuditor.exe` 파일을 더블클릭합니다.
2. UAC(사용자 계정 컨트롤) 대화 상자가 자동으로 나타납니다:
   - "예"를 클릭하여 관리자 권한을 허용합니다.
   - 이 권한은 Windows 이벤트 로그 및 감사 정책에 접근하기 위해 필요합니다.
3. 애플리케이션이 시작되면 메인 인터페이스가 표시됩니다.

### 바로가기 만들기 (선택사항)
1. `ScreensaverAuditor.exe` 파일을 우클릭하여 "바로 가기 만들기"를 선택합니다.
2. 생성된 바로가기를 바탕화면이나 시작 메뉴로 이동합니다.
3. 매번 관리자 권한으로 실행되도록 이미 설정되어 있습니다.

## 사용 방법 🔍

### 실행 모드 선택하기

화면보호기 감사 도구는 사용자의 편의에 맞게 두 가지 모드로 실행할 수 있습니다:

#### 1️⃣ 그래픽 사용자 인터페이스(GUI) 모드
```
ScreensaverAuditor.exe
```
![GUI 모드 스크린샷](https://예시링크/gui_screenshot.png)

**장점:**
- ✓ 사용하기 쉬운 탭 기반 인터페이스
- ✓ 직관적인 날짜 선택 및 필터 옵션
- ✓ 감사 결과 즉시 확인 가능
- ✓ 단 몇 번의 클릭으로 모든 기능 이용 가능
- ✓ 상세한 도움말 및 안내 제공

**사용 방법:**
1. 프로그램을 더블클릭하여 실행합니다.
2. "감사 설정" 탭에서 필요한 옵션을 설정합니다.
3. "감사 실행" 버튼을 클릭하면 자동으로 결과를 수집합니다.
4. "감사 결과" 탭에서 수집된 데이터를 바로 확인할 수 있습니다.

#### 2️⃣ 명령줄 인터페이스(CLI) 모드
```
ScreensaverAuditor.exe --console [옵션]
```

**장점:**
- ✓ 배치 파일이나 스크립트에 통합 가능
- ✓ 예약 작업으로 자동화 가능
- ✓ 원격 실행에 적합
- ✓ 리소스 사용량 최소화
- ✓ 대규모 환경에서 효율적

### 명령줄 옵션 가이드

명령줄 모드에서는 다양한 옵션을 조합하여 강력하고 유연한 감사 작업을 수행할 수 있습니다.

```
ScreensaverAuditor.exe --console [옵션]
```

#### 🔍 기본 옵션:
| 옵션 | 설명 | 예시 |
|------|------|------|
| `--console` | GUI 대신 콘솔 모드로 실행합니다. | `ScreensaverAuditor.exe --console` |
| `--help` 또는 `-h` | 도움말을 표시합니다. | `ScreensaverAuditor.exe --console --help` |
| `--audit` | 기본 설정으로 감사를 실행합니다. (최근 7일간) | `ScreensaverAuditor.exe --console --audit` |

#### 📅 날짜 관련 옵션:
| 옵션 | 설명 | 예시 |
|------|------|------|
| `--start-date <날짜>` | 조회 시작 날짜를 지정합니다. (yyyy-MM-dd 형식) | `--start-date 2025-01-01` |
| `--end-date <날짜>` | 조회 종료 날짜를 지정합니다. (yyyy-MM-dd 형식) | `--end-date 2025-01-31` |

#### 👥 사용자 및 출력 관련 옵션:
| 옵션 | 설명 | 예시 |
|------|------|------|
| `--user <사용자명>` | 특정 사용자만 조회합니다. | `--user Administrator` |
| `--output <파일경로>` | 결과 저장 파일 경로를 지정합니다. | `--output C:\Reports\audit.xlsx` |

#### 🔐 정책 관련 옵션:
| 옵션 | 설명 | 예시 |
|------|------|------|
| `--enable-policy` | 화면보호기 감사 정책을 활성화합니다. | `--enable-policy` |
- `--end-date <날짜>`: 종료 날짜를 지정합니다. (예: 2024-01-31)
- `--output <파일경로>`: 결과를 Excel 파일로 저장합니다. (기본값: ScreensaverEvents.xlsx)
- `--user <사용자>` 또는 `--username <사용자>`: 특정 사용자의 화면보호기 이벤트만 필터링합니다.
- `--help`: 도움말을 표시합니다.

### 사용 예시 📝

#### GUI 모드 사용법
1. `ScreensaverAuditor.exe`를 더블클릭하거나 명령줄에서 그냥 실행합니다.
   ```
   ScreensaverAuditor.exe
   ```
2. "감사 설정" 탭에서 날짜 범위와 사용자명(선택적)을 설정합니다.
3. "결과 저장 경로"를 지정합니다.
4. "감사 정책 활성화" 버튼을 클릭하여 정책을 활성화합니다. (관리자 권한 필요)
5. "감사 실행" 버튼을 클릭하여 감사를 시작합니다.
6. 결과는 자동으로 Excel 파일로 저장되며, "감사 결과" 탭에서 바로 확인할 수 있습니다.

#### 콘솔 모드 사용법

1. 기본 설정으로 간단히 감사하기:
```
ScreensaverAuditor.exe --console --audit
```

2. 감사 정책 활성화하기:
```
ScreensaverAuditor.exe --console --enable-policy
```

### 📋 유용한 명령줄 예시 모음

다음은 일상적인 보안 관리 작업을 위한 명령줄 예시입니다:

#### 1️⃣ 일일 감사 보고서 생성
```bash
# 오늘의 화면보호기 활동을 report_daily.xlsx 파일로 저장
ScreensaverAuditor.exe --console --start-date 2025-05-12 --output "C:\Reports\report_daily.xlsx"
```

#### 2️⃣ 특정 부서 감사 (사용자 목록 파일 사용)
```bash
# users.txt 파일에 있는 모든 사용자 대상으로 감사 실행
ScreensaverAuditor.exe --console --users-file "C:\Data\finance_team.txt" --output "C:\Reports\finance_dept.xlsx"
```

#### 3️⃣ 정기 감사를 위한 배치 파일 예시
```batch
@echo off
REM 매주 월요일에 지난 주 보고서 생성
set REPORT_PATH=C:\Reports\weekly_%date:~0,4%%date:~5,2%%date:~8,2%.xlsx
ScreensaverAuditor.exe --console --days 7 --output %REPORT_PATH%
echo 보고서가 생성되었습니다: %REPORT_PATH%
```

#### 4️⃣ 자동화된 정책 점검 및 감사
```bash
# 정책을 활성화하고 즉시 감사 실행 후 결과 저장
ScreensaverAuditor.exe --console --enable-policy --audit --output "C:\Reports\policy_audit.xlsx"
```

#### 5️⃣ 장기 분석을 위한 월별 데이터 수집
```bash
# 지난 달 전체 데이터를 수집하여 월간 보고서 생성
ScreensaverAuditor.exe --console --start-date 2025-04-01 --end-date 2025-04-30 --output "C:\Reports\monthly_april.xlsx" --detailed
```

## 결과 해석 📈

프로그램은 다음과 같은 정보를 제공합니다:
- 사용자별 화면보호기 실행 횟수
- 총 화면보호기 지속 시간(시간 단위)
- 상세 활성화/비활성화 기록

Excel 출력에는 다음 항목이 포함됩니다:
- 이벤트 시간
- 이벤트 ID (4802: 시작, 4803: 종료)
- 이벤트 유형 (화면보호기 시작/종료)
- PC 관리번호
- 사용자 계정 정보
- 세션 ID
- 지속 시간(분)
- 작업 유형
- 활동 ID
- 이벤트 제공자
- 감사 결과

## 종료 코드 📝

프로그램은 다음과 같은 종료 코드를 반환합니다:

- `0`: 정상 종료
- `1`: 관리자 권한 오류
- `2`: 일반 오류 (잘못된 옵션 등)
- `3`: 날짜 형식 오류 (YYYY-MM-DD 형식이 아닌 경우)

## 주의사항 ⚠️

1. 감사 정책 설정을 위해서는 반드시 관리자 권한으로 실행해야 합니다.
2. 처음 사용 시 `--enable-policy` 옵션으로 감사 정책을 활성화해야 합니다.
3. 과거 데이터는 Windows 이벤트 로그에 저장된 범위 내에서만 조회 가능합니다.
4. `--user` 옵션을 사용할 경우, 사용자 이름은 대소문자를 구분하지 않고 검색됩니다.

## 문제 해결 가이드 🛠️

![문제해결](https://예시링크/troubleshooting.png)

### 권한 관련 문제

| 💥 문제 증상 | ✅ 해결 방법 |
|------------|------------|
| "권한이 부족합니다" 오류 메시지 | 프로그램이 자동으로 관리자 권한을 요청합니다.<br>UAC 메시지가 표시되면 "예"를 클릭하세요. |
| "감사 정책을 설정할 수 없습니다" | 로컬 보안 정책에 대한 접근 권한이 있는지 확인하세요.<br>일부 엔터프라이즈 환경에서는 도메인 정책이 적용될 수 있습니다. |
| "이벤트 로그에 접근할 수 없습니다" | 관리자 그룹에 속해 있는지 확인하세요.<br>이벤트 로그 서비스가 실행 중인지 확인하세요. |

### 데이터 조회 문제

| 💥 문제 증상 | ✅ 해결 방법 |
|------------|------------|
| 데이터가 보이지 않음 | 1. 감사 정책이 활성화되어 있는지 확인<br>2. 조회 기간이 올바른지 확인<br>3. Windows 이벤트 로그가 활성화되어 있는지 확인<br>4. 정확한 사용자 이름을 입력했는지 확인 |
| 일부 이벤트만 표시됨 | 1. Windows 이벤트 로그 크기 설정 확인<br>2. 이벤트 로그가 순환되어 오래된 데이터가 삭제됐을 수 있습니다.<br>3. 시작 날짜를 최근 날짜로 변경해 보세요. |
| 실행 시간이 너무 오래 걸림 | 1. 조회 기간을 줄여보세요.<br>2. 특정 사용자로 필터링해보세요.<br>3. 시스템 성능 및 이벤트 로그 크기를 확인하세요. |

### GUI 관련 문제

| 💥 문제 증상 | ✅ 해결 방법 |
|------------|------------|
| UI가 표시되지 않음 | 1. .NET 6.0이 올바르게 설치되어 있는지 확인<br>2. `--console` 옵션으로 콘솔 모드 시도<br>3. Windows 업데이트 확인 |
| Excel 열기 실패 | 1. Microsoft Excel 또는 호환 소프트웨어가 설치되어 있는지 확인<br>2. 파일 경로에 특수문자 없는지 확인<br>3. 다른 Excel 파일은 열리는지 시험 |
| UI 요소 겹침 또는 왜곡 | 1. 화면 해상도가 최소 1024x768 이상인지 확인<br>2. Windows 디스플레이 설정에서 배율을 100%로 설정<br>3. 최신 그래픽 드라이버 설치 확인 |

### 보안 및 감사 정책 설정 🔐

#### 자동 정책 설정 프로세스

화면보호기 감사 도구는 필요한 감사 정책을 자동으로 설정합니다:

![감사 설정](https://예시링크/audit_policy.png)

```powershell
# 감사 정책 설정 명령
auditpol.exe /set /subcategory:"기타 로그온/로그오프 이벤트" /success:enable /failure:enable
```

#### 정책 설정 확인 방법

정상적으로 설정되었는지는 다음 방법으로 확인할 수 있습니다:

1. **GUI에서 확인**: "감사 설정" 탭의 "현재 정책 상태" 섹션에서 확인
2. **명령줄에서 확인**:
   ```powershell
   auditpol.exe /get /subcategory:"기타 로그온/로그오프 이벤트"
   ```

3. **예상 결과**:
   ```
   시스템 감사 정책
   범주/하위 범주                    설정
   로그온/로그오프
     기타 로그온/로그오프 이벤트            성공 및 실패
   ```

#### 기업 환경에서의 정책 관리

기업 환경에서는 도메인 정책이 로컬 정책보다 우선할 수 있습니다:

1. **도메인 환경**:
   - 도메인 관리자에게 "기타 로그온/로그오프 이벤트" 감사 정책 활성화를 요청하세요.
   - 그룹 정책 객체(GPO)를 통해 여러 컴퓨터에 일괄 적용할 수 있습니다.

2. **정책 충돌 해결**:
   - 로컬 정책과 도메인 정책 충돌 시 도메인 정책이 우선합니다.
   - 권한 문제 발생 시 IT 부서나 시스템 관리자에게 문의하세요.

## 라이선스 및 법적 고지 📜

### 라이선스

이 프로그램은 MIT 라이선스 하에 배포됩니다.

### 개인정보 처리 안내

이 도구는 개인정보를 수집하지만, 오직 로컬 시스템 내에서만 처리합니다:
- 수집하는 정보: 사용자 ID, 세션 ID, 화면보호기 사용 시간
- 정보 사용 목적: 보안 정책 준수 모니터링
- 정보 저장 위치: 사용자가 지정한 로컬 Excel 파일
- 외부 전송 없음: 수집된 정보는 외부로 전송되지 않습니다