# 화면보호기 감사 도구 (ScreensaverAuditor) 📊

화면보호기 감사 도구는 Windows 시스템에서 사용자들의 화면보호기 사용 현황을 분석하고 리포트하는 도구입니다.

## 주요 기능 🌟

- 📋 화면보호기 이벤트 로그 수집
- 📊 사용자별 화면보호기 사용 통계 분석
- 📅 기간별 데이터 조회 가능
- 📁 CSV 형식으로 결과 내보내기
- 🔐 감사 정책 자동 설정
- 👤 특정 사용자 필터링

## 시스템 요구사항 💻

- Windows 운영체제
- .NET 6.0 이상
- 관리자 권한 (감사 정책 설정 시 필요)

## 설치 방법 📥

1. 최신 릴리즈에서 `ScreensaverAuditor.exe` 파일을 다운로드합니다.
2. 원하는 위치에 파일을 저장합니다.

## 사용 방법 🔍

### 기본 실행
```
ScreensaverAuditor.exe
```
- 기본적으로 최근 7일간의 데이터를 분석합니다.

### 명령줄 옵션

```
ScreensaverAuditor.exe [옵션]
```

#### 사용 가능한 옵션:
- `--enable-policy`: 화면보호기 감사 정책을 활성화합니다.
- `--start-date <날짜>`: 시작 날짜를 지정합니다. (예: 2024-01-01)
- `--end-date <날짜>`: 종료 날짜를 지정합니다. (예: 2024-01-31)
- `--output <파일경로>`: 결과를 CSV 파일로 저장합니다. (기본값: ScreensaverEvents.csv)
- `--user <사용자>` 또는 `--username <사용자>`: 특정 사용자의 화면보호기 이벤트만 필터링합니다.
- `--help`: 도움말을 표시합니다.

### 사용 예시 📝

1. 감사 정책 활성화하기:
```
ScreensaverAuditor.exe --enable-policy
```

2. 특정 기간의 데이터 조회:
```
ScreensaverAuditor.exe --start-date 2024-01-01 --end-date 2024-01-31
```

3. 특정 사용자의 데이터 조회:
```
ScreensaverAuditor.exe --user johndoe
```

4. 결과를 CSV 파일로 저장:
```
ScreensaverAuditor.exe --output report.csv
```

5. 모든 옵션 조합 사용:
```
ScreensaverAuditor.exe --enable-policy --start-date 2024-01-01 --end-date 2024-01-31 --user johndoe --output report.csv
```

## 결과 해석 📈

프로그램은 다음과 같은 정보를 제공합니다:
- 사용자별 화면보호기 실행 횟수
- 총 화면보호기 지속 시간(시간 단위)
- 상세 활성화/비활성화 기록

### CSV 출력 형식
```
사용자,화면보호기 실행 횟수,총 지속 시간(시간)
user1,24,12.5
user2,15,8.2
```

## 종료 코드 📝

프로그램은 다음과 같은 종료 코드를 반환합니다:

- `0`: 정상 종료
- `1`: 관리자 권한 오류
- `2`: 일반 오류 (잘못된 옵션 등)
- `3`: 날짜 형식 오류 (YYYY-MM-DD 형식이 아닌 경우)
- `4`: 사용자명 미입력 오류 (--user 옵션 사용 시)

## 주의사항 ⚠️

1. 감사 정책 설정을 위해서는 반드시 관리자 권한으로 실행해야 합니다.
2. 처음 사용 시 `--enable-policy` 옵션으로 감사 정책을 활성화해야 합니다.
3. 과거 데이터는 Windows 이벤트 로그에 저장된 범위 내에서만 조회 가능합니다.
4. `--user` 옵션을 사용할 경우, 사용자 이름은 대소문자를 구분하지 않고 검색됩니다.

## 문제 해결 🔧

### 관리자 권한 오류
- 해결방법: EXE 파일을 우클릭 → "관리자 권한으로 실행" 선택

### 데이터가 보이지 않는 경우
1. 감사 정책이 활성화되어 있는지 확인
2. 조회 기간이 올바른지 확인
3. Windows 이벤트 로그가 활성화되어 있는지 확인
4. `--user` 옵션을 사용할 경우, 정확한 사용자 이름을 입력했는지 확인

### 날짜 형식 오류
- 해결방법: 날짜는 반드시 'YYYY-MM-DD' 형식으로 입력 (예: 2024-01-31)
- 잘못된 예: 2024/01/31, 31-01-2024

### 사용자명 지정 오류
- 해결방법: --user 옵션 사용 시 반드시 사용자명 입력
- 예시: `--user johndoe`

### 감사 정책 설정 🔐

감사 정책은 다음과 같이 자동으로 설정됩니다:

```powershell
# 감사 정책 설정
auditpol.exe /set /subcategory:"기타 로그온/로그오프 이벤트" /success:enable /failure:enable

# 설정 확인
auditpol.exe /get /subcategory:"기타 로그온/로그오프 이벤트"
```

정상적으로 설정되면 다음과 같은 결과가 출력됩니다:
```
시스템 감사 정책
범주/하위 범주                    설정
로그온/로그오프
  기타 로그온/로그오프 이벤트            성공 및 실패
```

### 감사 정책 오류
- 해결방법: 감사 정책이 제대로 설정되었는지 확인
- 확인 방법: `auditpol.exe /get /subcategory:"기타 로그온/로그오프 이벤트"` 실행
- 예상 결과: "성공 및 실패" 설정 확인

## 라이선스 📜

이 프로그램은 MIT 라이선스 하에 배포됩니다.